' Gambas class file


Public Sub TextEdit1_Change()
  Static spurious As Boolean = False
  If spurious Then 
    spurious = False
  Else 
    Dim text As String = TextEdit1.Text
    If Comp(text, "") = 0 Then Return 
    
    spurious = True
    
    Dim selStart As Integer = TextEdit1.Selection.Start
    Dim selLen As Integer = TextEdit1.Selection.Length
    
    TextEdit1.RichText = SyntaxColorer.Color(text)
    
    TextEdit1.Select(selStart, selLen)
  Endif

End

Const MIN_FONT_SIZE As Float = 7.0
Const MAX_FONT_SIZE As Float = 70.0
Const ZOOM_SPEED As Float = 2.0

Public Sub TextEdit1_MouseWheel()
  
  Dim size As Float = TextEdit1.Font.Size
  If Mouse.Control Then
    size += Mouse.Delta * ZOOM_SPEED
    If size < MIN_FONT_SIZE Then size = MIN_FONT_SIZE
    If size > MAX_FONT_SIZE Then size = MAX_FONT_SIZE
    
    TextEdit1.Font.Size = size
    Stop Event
  Endif
  
End


Public Sub Form_Open()

  Splitter1.Layout = [70, 30]

End
